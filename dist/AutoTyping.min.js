var AutoTyping
!function(t){!function(t){t[t.keyStroke=0]="keyStroke",t[t.timer=1]="timer",t[t.default=2]="default"}(t.ListnerType||(t.ListnerType={}))
var e,o=t.ListnerType
!function(t){t[t.Add=0]="Add",t[t.Remove=1]="Remove",t[t.Wait=2]="Wait"}(e||(e={}))
var r=function(){function t(t){this.element=t}return t.prototype.addTextNode=function(t){try{return this.element.appendChild(document.createTextNode(t)),!0}catch(t){return console.log(t),!1}},t.prototype.removeLastTextNode=function(){var t=this.element.lastChild
return!!t&&(this.element.removeChild(t),!0)},t}(),n=function(){function t(t,e){this.corpus=e,this.corpusLength=this.corpus.length,this.corpusPointer=-1,this.textNodeManager=t}return t.prototype.doNext=function(){this.corpusPointer++,this.corpusPointer<this.corpusLength&&this.textNodeManager.addTextNode(this.corpus[this.corpusPointer])},t.prototype.hasNext=function(){return this.corpusPointer<this.corpusLength},t}(),i=function(){function t(t,e){this.textNodeManager=t,this.itemToRemove=e}return t.prototype.doNext=function(){this.itemToRemove>0&&(this.textNodeManager.removeLastTextNode(),this.itemToRemove--)},t.prototype.hasNext=function(){return this.itemToRemove>0},t}(),s=function(){function t(t){this.strokeToWait=t}return t.prototype.doNext=function(){--this.strokeToWait},t.prototype.hasNext=function(){return this.strokeToWait>0},t}(),p=function(){function t(t,e){this.textNodeManger=new r(e),this.corpusArr=this.stringToCorpusArr(t).reverse()}return t.prototype.stringToCorpusArr=function(t){var e=this
return t.split(/(\^#\d+#\^|\^@\d+@\^)/g).map(function(t){return e.stringToCorpus(t)})},t.prototype.stringToCorpus=function(e){return t.removePattern.test(e)?new i(this.textNodeManger,parseInt(e.slice(2,-2))||0):t.waitPattern.test(e)?new s(parseInt(e.slice(2,-2))||0):new n(this.textNodeManger,e)},t.prototype.hasNext=function(){for(;(null==this.currCorpus||0==this.currCorpus.hasNext())&&this.corpusArr.length>0;)this.currCorpus=this.corpusArr.pop()
return null!=this.currCorpus&&(this.currCorpus.hasNext()||this.corpusArr.length>0)},t.prototype.doNext=function(){return!!this.hasNext()&&(this.currCorpus.doNext(),this.hasNext())},t.removePattern=new RegExp("^\\^#\\d+#\\^$"),t.waitPattern=new RegExp("^\\^@\\d+@\\^$"),t}(),u=function(){function t(t,e,r,n,i){this.corpusManager=new p(e,t),this.type=r==o.default?o.keyStroke:r,this.stopped=!1,this.strokeSpeed=n,this.callback=i}return t.prototype.next=function(){this.corpusManager.doNext()||(console.log("complete corpus managed."),this.stop(),"function"==typeof this.callback&&this.callback())},t.prototype.start=function(){var t=this
switch(this.stopped=!1,this.type){case o.keyStroke:document.body.addEventListener("keyup",function(){if(!t.stopped)for(var e=0;e<t.strokeSpeed;e++)t.next()},!1)
break
case o.timer:this.timerCaller()}},t.prototype.timerCaller=function(){var t=this
this.appTimerToken=setTimeout(function(){t.stopped||requestAnimationFrame(function(){t.next(),t.timerCaller()})},100*this.strokeSpeed)},t.prototype.stop=function(){switch(this.type){case o.keyStroke:this.stopped=!0
break
case o.timer:this.stopped=!0,clearTimeout(this.appTimerToken)}},t}()
t.App=u}(AutoTyping||(AutoTyping={}))
